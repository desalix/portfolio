---
import Night_mode from "../assets/night_mode.svg"
import Light_mode from "../assets/light_mode.svg"
---

<nav class="fixed top-6 left-1/2 animate-slide-in-top -translate-x-1/2 z-50 max-w-3xl w-full">
  <div class="dark:bg-black/80 bg-white/80 backdrop-blur-md border-2 dark:border-white/60 border-black/80 rounded-full px-8 py-4 shadow-xl shadow-white/15">
    <div class="flex flex-row items-center justify-between">
      <!-- Left HOME button -->
      <div class="text-center">
        <a href="/" class="dark:text-gray-400 text-gray-700 dark:hover:text-white hover:text-black transition-all duration-300">
          Home
        </a>
      </div>

      <!-- Middle navigation items -->
      <div class="flex justify-center items-center relative" data-hover-pill>
        <div id="hover-pill"
             class="pointer-events-none absolute top-0 left-0 rounded-xl dark:bg-gray-900/90 bg-gray-100/90
              opacity-0 transition-all duration-300 ease-out will-change-transform"></div>
        <div>
          <a href="#projects" class="nav-link">
            Projects
          </a>
        </div> 
        <div>
          <a href="#about" class="nav-link">
            About
          </a>
        </div>
        <div>
          <a href="#contact" class="nav-link">
            Contact
          </a>
        </div>
      </div>

      <!-- Color MODE button -->
        <div class="flex flex-row text-center gap-x-4">
          <button type="button" id="theme-selector">

            <Night_mode class="hidden dark:inline"/>

            <Light_mode class="dark:hidden"/>
            
          </button>
        </div>
    </div>
  </div>
</nav>


<script>
  document.addEventListener('DOMContentLoaded', () => {
    const wrapper = document.querySelector<HTMLElement>('[data-hover-pill]');
    if (!wrapper) return;
    const wrapperEl: HTMLElement = wrapper;

    const pill = wrapperEl.querySelector<HTMLElement>('#hover-pill');
    if (!pill) return;
    const pillEl: HTMLElement = pill;

    pillEl.style.top = '0px';
    pillEl.style.left = '0px';

    const links = Array.from(
      wrapperEl.querySelectorAll<HTMLAnchorElement>('.nav-link')
    );
    if (links.length === 0) return;

    function movePill(toEl: HTMLElement) {
      const wrapBox = wrapperEl.getBoundingClientRect();
      const box = toEl.getBoundingClientRect();
      const x = box.left - wrapBox.left;
      const y = box.top - wrapBox.top;

      pillEl.style.transform = `translate(${x}px, ${y}px)`;
      pillEl.style.width = `${box.width}px`;
      pillEl.style.height = `${box.height}px`;
      pillEl.style.opacity = '1';
    }

    links.forEach((a) => {
      a.addEventListener('mouseenter', () => movePill(a));
    });

    wrapperEl.addEventListener('mouseleave', () => {
      pillEl.style.opacity = '0';
    });
  });
</script>

<script>
  document.getElementById('theme-selector')?.addEventListener('click', () => {
    if (localStorage.theme === 'dark') {
      localStorage.theme = 'light';
      document.documentElement.classList.remove('dark');
    } else {
      localStorage.theme = 'dark';
      document.documentElement.classList.add('dark');
    }
  });
</script>
